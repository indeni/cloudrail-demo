
WARNINGs found:
Rule: Ensure IMDSv2 is used and IMDSv1 is disabled
 - 1 Resources Exposed:
-----------------------------------------------
   - Exposed Resource: [aws_instance.test] (main.tf:53)
     Violating Resource: [aws_instance.test]  (main.tf:53)

     Evidence:
             | The EC2 aws_instance.test is allowing IMDSv1


-----------------------------------------------
Rule: Ensure that the private bucket's policy reference a VPC Endpoint as source
 - 1 Resources Exposed:
-----------------------------------------------
   - Exposed Resource: [aws_s3_bucket.public-bucket] (main.tf:60)
     Violating Resource: [aws_s3_bucket.public-bucket]  (main.tf:60)

     Evidence:
             | ~Bucket aws_s3_bucket.public-bucket
             | is accessible via VPC endpoint vpce-0d03e8972ac4910df
             | in VPC sfdc-somestage-consoleme
             | with a policy that is not restricting requests sourced from a VPC Endpoint.


-----------------------------------------------
Rule: Ensure S3 buckets are set to be encrypted at rest
 - 1 Resources Exposed:
-----------------------------------------------
   - Exposed Resource: [aws_s3_bucket.public-bucket] (main.tf:60)
     Violating Resource: [aws_s3_bucket.public-bucket]  (main.tf:60)

     Evidence:
             | The S3 bucket aws_s3_bucket.public-bucket is not set to be encrypted at rest


-----------------------------------------------
Rule: Allow only private AMIs to be used
 - 1 Resources Exposed:
-----------------------------------------------
   - Exposed Resource: [aws_instance.test] (main.tf:53)
     Violating Resource: [ami-099e921e69356cf89]  (Not found in TF)

     Evidence:
             | The EC2 aws_instance.test uses AMI ami-099e921e69356cf89, which is public


-----------------------------------------------
Rule: Ensure all data stored in the Launch configuration EBS is securely encrypted
 - 1 Resources Exposed:
-----------------------------------------------
   - Exposed Resource: [aws_instance.test] (main.tf:53)
     Violating Resource: [aws_instance.test]  (main.tf:53)

     Evidence:
             | This rule evaluated aws_instance.test only, it is not a context-aware rule.


-----------------------------------------------